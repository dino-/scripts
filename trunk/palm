#! /bin/sh

#--------------------------------------------------------------------------
# $RCSfile$
#--------------------------------------------------------------------------
# $Revision: 88 $
# $Date: 2005-06-22 00:26:09 -0400 (Wed, 22 Jun 2005) $
# $Author: dmorelli $
#
# Script to do some common tasks with Palm PDAs
#--------------------------------------------------------------------------


PORT=net:any
SYNCFOLDER=~/.palmpda
USAGE=`cat <<EOF
Perform Palm PDA operations
usage:
  palm -i file1 file2 ...   Install files
  palm -s                   Sync the PDA
  palm --help               This help information.
EOF`

waitForDevice()
{
	echo Waiting for PDA...
	sleep 3s

	echo Connecting now...
}

displayUsage()
{
	echo "$USAGE"
	exit
}

# It all starts here

# No args or user requested help
if [ "$#" -lt "1" -o "$1" == "--help" ]
then displayUsage; fi

# Parse arguments
while getopts "is" opt
do
	if [ ! "$action" == "" ]
	then
		echo "Only one action must be chosen"
		displayUsage
	fi
	action=$opt
done

# Perform action
case $action in
	i)
		waitForDevice

		shift
		pilot-xfer -p $PORT -i "$@"
		break;;

	s)
		waitForDevice

		pilot-xfer -p $PORT -s ${SYNCFOLDER}
		break;;
esac
echo Done
